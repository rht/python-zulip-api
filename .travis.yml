language: python
sudo: required
python:
  - "3.4"
env:
  matrix:
    - TEST_SUITE=test-main
  global:
    - BOTO_CONFIG=/tmp/nowhere
matrix:
  include:
  - python: "3.4"
    env: TEST_SUITE=backend
    script:
    - wget https://github.com/houstondatavis/slack-export/archive/master.zip
    - mv master.zip slack-export-master.zip
    - zulip/integrations/slack/slackdata2zulipdata.py $PWD/slack-export-master.zip
    - mv zulip_data.zip $HOME
    - cd
    - ls
    - git clone https://github.com/zulip/zulip.git
    - cd zulip
    - ./tools/travis/setup-backend
    - ./manage.py import ../zulip_data.zip
    addons:
      postgresql: "9.3"
install:
  - tools/provision
  - source zulip-api-py*-venv/bin/activate
after_success:
  - pip install codecov
  - codecov
